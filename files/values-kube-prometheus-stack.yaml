grafana:
  enabled: true
  adminUser: {{ grafana_admin_user | quote }}
  adminPassword: {{ grafana_admin_password | quote }}

  service:
    type: ClusterIP
    port: 80

  persistence:
    enabled: true
    storageClassName: {{ storage_class }}
    size: {{ grafana_storage }}

  # üß© Sidecar t·ª± ƒë·ªông nh·∫≠n dashboards v√† datasources
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      folder: /var/lib/grafana/dashboards
      searchNamespace: ALL
    datasources:
      enabled: true
      label: grafana_datasource
      searchNamespace: ALL

  # üß† Provider hi·ªÉn th·ªã folder "Scenario 1 - Auto Scaling"
  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
        - name: "Scenario1"
          orgId: 1
          folder: "Scenario 1 - Auto Scaling"
          type: file
          disableDeletion: false
          updateIntervalSeconds: 10
          options:
            path: /var/lib/grafana/dashboards

  # üîó Datasources m·∫∑c ƒë·ªãnh
  additionalDataSources:
    - name: Loki
      type: loki
      access: proxy
      url: http://loki:3100
      isDefault: false

    - name: Tempo
      type: tempo
      access: proxy
      url: http://tempo:3100
      jsonData:
        httpMethod: GET
        tracesToLogsV2:
          datasourceUid: grafana-loki-datasource
          filterByTraceID: true
          filterBySpanID: true
          tags:
            - "job"

prometheus:
  prometheusSpec:
    retention: 7d
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: {{ storage_class }}
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: {{ prometheus_storage }}

    # B·∫≠t thu metrics cho HPA v√† Cluster Autoscaler
    podMonitorSelectorNilUsesHelmValues: false
    serviceMonitorSelectorNilUsesHelmValues: false
    ruleSelectorNilUsesHelmValues: false

alertmanager:
  enabled: true
  alertmanagerSpec:
    # üîê Tr·ªè t·ªõi Secret ch·ª©a c·∫•u h√¨nh g·ª≠i Gmail
    configSecret: alertmanager-gmail
    replicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 300m
        memory: 256Mi
    retention: 120h
    logLevel: info

kube-state-metrics:
  enabled: true

nodeExporter:
  enabled: true

crds:
  enabled: true
